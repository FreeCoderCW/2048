# 前端布局

1. 搭建前端整体框架；
2. 引入`css`文件布局前端样式；
3. 修改前端样式，调整头部颜色和字体；
4. 布局游戏界面的样式；
5. 优化单元格布局方式，美化界面；

# 基本方法实现

1. 添加随机生成数字的方法，利用Math.random()方法实现；
2. 利用` jQuery`库中的animate方法实现数字和格子的移动动画效果；
3. 修改`js`代码，完善移动动画；





# 核心方法讲解

本项目的核心方法为格子和数字的移动功能，即move系列方法。

- 当按键按下时，调用对应方向的move方法，当move方法返回为真时，执行获取分数的方法、随机生成数字的方法（因为每次移动之后都需要随机生成一个数字）和判断游戏是否结束的方法（因为每次移动都有可能导致游戏结束，束，所以每次移动都要判断）；代码样例如下：

  ` case 37://left` 
  ` if(moveLeft()){` 

  ` getScore();` 

  `randomNum();`

  ` setTimeout(“isgameover()”,400);`

  `}`

- move方法中，先调用`canMove`系列方法判定能否移动，然后通过两次循环来实现移动，当落脚位置为空且中间没有障碍物时，执行移动动画，然后改变数字。第二种情况是落脚位置的数字和本来的数字相等且中间没有障碍物时，执行移动动画，且将相同的数字合并。样例代码如下：

  ` function moveLeft() {` 

     ` if (!canMoveLeft(board))`

  ​        ` return false; `

  ​    ` //函数核心 `

  ​    ` for (var i = 0; i < 4; i++) `

  ​         `for (var j = 1; j < 4; j++) {//第一列的数字不可能向左移动 `

  ​            ` if (board[i][j] !== 0) { `

  ​                ` //(i,j)左侧的元素 `

  ​                ` for (var k = 0; k < j; k++) { `

  ​                    ` //落脚位置的是否为空 && 中间没有障碍物 `

  ​                    ` if (board[i][k] === 0 && noBlockHorizontal(i, j, k, board)) { `

  ​                         `//满足条件就移动 `

  ​                         `moveAnimation(i, j, i, k); `

  ​                        ` board[i][k] = board[i][j]; `

  ​                         ` board[i][j] = 0; ` 

  ​                    `  } ` 

  ​                     ` //落脚位置的数字和本来的数字相等 && 中间没有障碍物 ` 

  ​                    `  else if (board[i][k] === board[i][j] && noBlockHorizontal(i, j, k, board)) { ` 

  ​                         ` moveAnimation(i, j, i, k); ` 

  ​                         ` board[i][k] += board[i][j]; ` 

  ​                        `  board[i][j] = 0; ` 

  ​                        `  score += board[i][k]; ` 

  ​                    `  } ` 

  ​                `  } ` 

  ​           `   } ` 

  ​       `   } ` 

- `canMove`方法通过判断在移动方向上是否有障碍物，以及是否有相同数字可以合并以及当前是否是边界行或者边界列来判断能否移动。代码片段如下：

  `function canMoveLeft(board) {`

     ` for (var i = 0; i < 4; i++)`

  ​       ` for (var j = 0; j < 4; j++)`

  ​           ` if (board[i][j] !== 0 && j !== 0)`

  ​              `  if (board[i][j - 1] === 0 || board[i][j - 1] === board[i][j])`

  ​                 `   return true;`

     ` return false;`

  `}`



# 为游戏增加方法

1. 增加判定功能（当数字不能移动且没有空余格子时，游戏结束）；
2. 添加`GameOver`模块，利用判定功能判定，当返回真时，模块显示；
3. 添加分数计算方法，显示实时分数；
4. 增加`newGame`按钮，点击时调用`init()`方法，即游戏的初始化；
5. 修改项目代码，解决格子移动动画失效问题；
6. 修改随机产生数字的动画效果，将原本的格子和数字同时生成，再定位，修改为，先生成格子，然后定位，再生成数字，使画面更流畅，平缓；
7. 添加排行榜按钮并布局，为前后端数据交互预留接口；





# 后端实现（数据库为MySQL）

1. 数据表结构：

   - 表名：`Score_name`;

   - 结构：

     | `username` | `score` |
     | ---------- | ------- |
     | `玩家1`    | `分数1` |
     | `玩家2`    | `分数2` |
     | `玩家3`    | `分数3` |

2. 用`jdbc`创建连接池，连接数据库，并封装成方法（方便后面的代码调用，避免重复书写，减少代码冗余度）；

3. 写另一个`java`文件，调用`jdbc`中的方法，实现数据库的查询和更改；

4. 查询方法：将查询结果按分数降序排序存在结果集里，然后对结果集进行处理，将名字为空的玩家名称自动改为“一位不愿意透露姓名的玩家”（防止用户不输入姓名，排行榜姓名列显示为空），将处理结果存入list返回；





# 方法完善

1. 添加姓名输入框和本局游戏分数框；
2. 增加判定功能，当玩家本局游戏分数大于当前排行榜最后一名时，弹出对话框，请玩家输入姓名，否则直接弹出`GameOver；`
3. 完善代码，将文件合并，删除不必要的文件；
4. 删除多余代码，封装重复代码，降低代码冗余度；
